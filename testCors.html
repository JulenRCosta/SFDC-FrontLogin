<!DOCTYPE html>
<html>
<head>
	<title></title>
	<script type="text/javascript">

		let lginPromise = new Promise((resolve, reject) => {

			var xhr = new XMLHttpRequest();
			var params = {
		      grant_type: "password",
		      client_id : "3MVG9HxRZv05HarRDCbMSbu0DqH.M_BA873rS54Uikz4KduKL01ag1GBMYK5UMf2.vflb4G3kmUSn244Iqdv0",
		      client_secret : "6655933965399586796",
		      username:"julenrcosta@dev.com",
		      password:"JrC&7012I4EdzNLjB4dpxbtek10V9baGL"};
			xhr.open("POST", 'https://julen-dev-ed.my.salesforce.com/services/oauth2/token?grant_type=password&client_id=3MVG9HxRZv05HarRDCbMSbu0DqH.M_BA873rS54Uikz4KduKL01ag1GBMYK5UMf2.vflb4G3kmUSn244Iqdv0&client_secret=6655933965399586796&username=julenrcosta@dev.com&password=JrC%267012I4EdzNLjB4dpxbtek10V9baGL', true);
			xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");

			xhr.onreadystatechange = function() { 
			    if (this.status === 200 && this.readyState == 4) {
			        console.log(this.response)
			        resolve(this.response)
			    }
			}
			xhr.send();

		}

		function login() {
			var xhr = new XMLHttpRequest();
			var params = {
		      grant_type: "password",
		      client_id : "3MVG9HxRZv05HarRDCbMSbu0DqH.M_BA873rS54Uikz4KduKL01ag1GBMYK5UMf2.vflb4G3kmUSn244Iqdv0",
		      client_secret : "6655933965399586796",
		      username:"julenrcosta@dev.com",
		      password:"JrC&7012I4EdzNLjB4dpxbtek10V9baGL"};
			xhr.open("POST", 'https://julen-dev-ed.my.salesforce.com/services/oauth2/token?grant_type=password&client_id=3MVG9HxRZv05HarRDCbMSbu0DqH.M_BA873rS54Uikz4KduKL01ag1GBMYK5UMf2.vflb4G3kmUSn244Iqdv0&client_secret=6655933965399586796&username=julenrcosta@dev.com&password=JrC%267012I4EdzNLjB4dpxbtek10V9baGL', true);
			xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");

			xhr.onreadystatechange = function() { 
			    if (this.status === 200 && this.readyState == 4) {
			        console.log(this.response)
			        return this.response
			    }
			}
			xhr.send();
		}
		
		function apisetAccount() {
			var responseLogin = lginPromise().then((res) => {
				 
				  	var http = new XMLHttpRequest()
					var params2 = {"Name":"Test"}
			        http.open('POST', 'https://julen-dev-ed.my.salesforce.com/services/data/v49.0/sobjects/account/')
			        http.setRequestHeader('Content-type', 'application/json')
					http.setRequestHeader('Authorization', 'Bearer ' + res.access_token)
					http.setRequestHeader('Cross-Origin', 'true')
			        http.send(JSON.stringify(params2))
			        http.onreadystatechange = function() {
			            if (this.status === 201 && this.readyState == 4) {
					        console.log(this.response)
					        
					    }
			        }
				});

			
		}


	</script>
</head>
<body>
	<button onclick="login()">TestCorsLogin</button>
	<button onclick="apisetAccount()">TestCorsInsertAccount</button>
</body>
</html>
